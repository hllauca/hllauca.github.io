[
  {
    "objectID": "resources.html",
    "href": "resources.html",
    "title": "Hydrological products",
    "section": "",
    "text": "Hydrological products\n\nThe PISCO_HyM_GR2M product is a data set of monthly flows throughout the Peruvian territory, simulated using the GR2M model. It contains time series of mean monthly flows from January 1981 to December 2022.\n\n# Download netcdf file using R\nrequire(RCurl)\nfilename &lt;- 'PISCO_HyM_GR2M_v1.1.nc'\nserver   &lt;- 'http://thredds.hydroshare.org/thredds/fileServer/hydroshare/resources/f1b537f338f24533af5dab946b51d215/data/contents'\ndownload.file(url=file.path(server,filename),destfile=filename)\n\n\nThe PISCO_HyD_ARNOVIC product is a data set of daily flows throughout the Peruvian territory, simulated using the ARNOVIC model. This product contains time series of mean daily flows from 1981-01-01 to 2022-12-31.\n\n# Download netcdf file using R\nrequire(RCurl)\nfilename &lt;- 'PISCO_HyD_ARNOVIC_v1.0.nc'\nserver   &lt;- 'http://thredds.hydroshare.org/thredds/fileServer/hydroshare/resources/f723d6c762ca45b6936dd9489bc44842/data/contents'\ndownload.file(url=file.path(server,filename),destfile=filename)\n\n\nThe SONICS dashboard has been developed for monitoring and forecasting fluvial floods in Peru. This system provides continuous updates on the current state of 12 thousand river reaches nationwide, and forecasts for a 7-day horizon.\n\n\n\n\n\n\nR packages\n\nGR2MSemiDistr is a package for the execution of the GR2M conceptual model at a semi-distributed level (by sub-basins) in large domains. This package processes the PISCO forcing data at the sub-basin level, identifies the optimal set of model parameters using the Shuffle Complex Evolutionary (SCE) algorithm, and routes monthly flows to the outlet of each sub-basin using the Weighted Flow Accumulation (WFAC) algorithm.\n\n\n\n\n\n# Installing the package\ndevtools::install_github(\"hllauca/GR2MSemiDistr\")\nlibrary(GR2MSemiDistr)\n\n\nRClimChange is a package developed for downloading and subsetting data from Global Climate Models (GCM) of the Coupled Model Intercomparison Project phase 6 (CMIP6). The data is extracted from NASA Earth Exchange Global Daily Downscaled Projections (NEX-GDDP, https://www.nccs.nasa.gov/services/data-collections/land-based-products/nex-gddp-cmip6).\n\n\n\n\n\n# Installing the package\ndevtools::install_github(\"hllauca/RClimChange\")\nlibrary(RClimChange)"
  },
  {
    "objectID": "publications.html",
    "href": "publications.html",
    "title": "Articles",
    "section": "",
    "text": "Articles\n\nLlauca, H., Lavado, W., Arestegui, M. Constraining flood forecasting uncertainties throw streamflow data assimilation in the Tropical Andes of Peru: Case of the Vilcanota River Basin. Water. 2023; 15(22), 3944. https://doi.org/10.3390/w15223944.\nLlauca, H., Leon, K., Lavado, W. Construction of a daily streamflow dataset for Peru using a similarity-based regionalization approach and a hybrid modeling framework. Journal of Hydrology: Regional Studies. 2023; 47, 101381. https://doi.org/10.1016/j.ejrh.2023.101381.\nSaavedra, D., Mendoza, P. A., Addor, N., Llauca, H., Vargas, X. A multi-objective approach to select hydrological models and constrain structural uncertainties for climate impact assessments. Hydrological Processes. 2021; 36(1), e14446. https://doi.org/10.1002/hyp.14446.\nLlauca H., Lavado-Casimiro, W., Montesinos, C., Santini, W., Rau, P. PISCO HyM GR2M : A Model of Monthly Water Balance in Peru (1981–2020). Water. 2021; 13(8), 1048. https://doi.org/10.3390/w13081048.\nLlauca H., Lavado-Casimiro, W., Leon, K., Jimenez, J., Traverso, K., Rau, P. Assessing Near Real-Time Satellite Precipitation Products for Flood Simulations at Sub-Daily Scales in a Sparsely Gauged Watershed in Peruvian Andes. Remote Sensing. 2021; 13(4), 826. https://doi.org/10.3390/rs13040826.\n\n\n\nConference papers\n\nLlauca, H., Leon, K., Lavado, W., and Felipe, O.: SONICS: A novel in-house development system for detection and forecasting potential river floods in Peru, HEPEX Workshop 2023, Norrköping, Sweden, 13–15 Sep 2023, EGU23-8144, https://hepex.org.au/a-look-to-the-past-hepex-workshop/.\nLlauca, H., Leon, K., Lavado, W., and Felipe, O.: SONICS: A new Peruvian hydrological dataset of simulated daily streamflow for flood monitoring and forecasting, EGU General Assembly 2023, Vienna, Austria, 24–28 Apr 2023, EGU23-8144, https://doi.org/10.5194/egusphere-egu23-8144.\nLlauca, H., Lavado, W., Montesinos, C., and Rau, P.: Monthly semi-distributed hydrological model at national scale in Peru, EGU General Assembly 2020, Online, 4–8 May 2020, EGU2020-3769, https://doi.org/10.5194/egusphere-egu2020-3769.\nLeon, K., Acuña, J., Llauca, H., Lavado, W., Suarez, W., Ordoñez, J., and Felipe, O. : Implementation of a flood forecasting system in a transboundary river basin, Peru – Ecuador , EGU General Assembly 2020, Online, 4–8 May 2020, EGU2020-12927, https://doi.org/10.5194/egusphere-egu2020-12927.\nAsurza Véliz, F. A., Traverso-Yucra, K. A., Lavado-Casimiro, W. S., Felipe-Obando, O., Montesinos-Cáceres, C. A., and Llauca-Soto, H. O.: Surface water resources assessment in Peru through SWAT hydrological model, EGU General Assembly 2020, Online, 4–8 May 2020, EGU2020-6308, https://doi.org/10.5194/egusphere-egu2020-6308.\nWaldo, L.-C., Juan Carlos, J., Harold, L., Karen, L., Clara, O., Alan, L., Adrian, H., Oscar, F., Julia, A., Pedro, R., and Jorge, A.: ANDES: The first system for flash flood monitoring and forecasting in Peru, EGU General Assembly 2020, Online, 4–8 May 2020, EGU2020-3759, https://doi.org/10.5194/egusphere-egu2020-3759.\n\n\n\nOthers studies\n\nLlauca Soto, H. (2023). Asimilación de caudales observados en la modelación hidrológica subdiaria del río Vilcanota en la estación Pisac. Available at https://hdl.handle.net/20.500.12542/2613.\nLlauca Soto, H. (2023). Asimilación de caudales observados en la modelación hidrológica subdiaria del río Vilcanota en la estación Pisac. Available at https://hdl.handle.net/20.500.12542/2613.\nLlauca Soto, H. (2018). Exploración del sensoramiento remoto en el rango de las microondas y su relación con el equivalente de agua nieve en los Andes Centrales de Chile. Available at https://repositorio.uchile.cl/handle/2250/167759.\nLlauca Soto, H. (2014). Estudio del balance hídrico superficial de las cuencas del Anya y del Mchique, departamento de Junín - Perú. Available at http://repositorio.lamolina.edu.pe/handle/20.500.12996/1833."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Education",
    "section": "",
    "text": "Education\n\nPhD. Student in Water Resources | National Agrarian University La Molina | Postgraduate School. 2022.\nMSc. in Water and Environmental Resources | University of Chile | Faculty of Physics and Mathematics Sciences | Department of Civil Engineering. 2018.\nAgricultural Engineer | National Agrarian University La Molina | Faculty of Agricultural Engineering. 2014.\n\n\n\nWork history\n\nPart-time Professor (2023-present) | Department of Civil and Environmental Engineering | University of Engineering and Technology (UTEC).\nResearcher in Hydrology (2019-present) | National Service of Meteorology and Hydrology of Peru (SENAMHI).\nResearch assistant in Snow Hydrology (2016-2018) | Department of Civil Engineering. University of Chile.\nHydrologist (2014-2015) | National Service of Meteorology and Hydrology of Peru (SENAMHI).\nFieldworker in Water Resources (2013). VLIR/UOS-UNALM program.\n\n\n\nAreas of interest\n\nLarge-sample hydrology\nHydrological modeling.\nFloods monitoring systems.\nUncertainties in hydrological forecasting.\nClimate change and water resources.\nHydroinformatics."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Harold Llauca",
    "section": "",
    "text": "Thanks for visiting my website. I am a professional in water resources with experience in the analysis and modeling of hydrological processes, development of short- and long-term streamflow forecasts, runoff prediction in ungauged basins, satellite precipitation products’ applications, climate change impacts on catchment hydrology, and hydroinformatic applications.\nMy recent work is focused on developing new climate services that support the detection and prediction of extreme hydrological hazards in Peru.\n\nHarold Llauca\nHydrology & Water Resources Engineering"
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Harold Llauca",
    "section": "",
    "text": "Thanks for visiting my website. I am a professional in water resources with experience in the analysis and modeling of hydrological processes, development of short- and long-term streamflow forecasts, runoff prediction in ungauged basins, satellite precipitation products’ applications, climate change impacts on catchment hydrology, and hydroinformatic applications.\nMy recent work is focused on developing new climate services that support the detection and prediction of extreme hydrological hazards in Peru.\n\nHarold Llauca\nHydrology & Water Resources Engineering"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Harold Llauca",
    "section": "",
    "text": "How to calibrate hydrological models?\n\n\n\n\n\n\n\nHydrological Modeling\n\n\nData-Science\n\n\nR programming\n\n\n\n\nBases for modeling hydrological systems and obtain reliable simulations\n\n\n\n\n\n\nJun 12, 2023\n\n\nHarold Llauca\n\n\n\n\n\n\n  \n\n\n\n\nGridded hydro-meteorological data for Peru\n\n\n\n\n\n\n\nPeru\n\n\nData-Science\n\n\nHydro-Meteorology\n\n\n\n\nA brief review about gridded data-sets developed for the Peruvian domain.\n\n\n\n\n\n\nJun 4, 2023\n\n\nHarold Llauca\n\n\n\n\n\n\n  \n\n\n\n\nTraining courses\n\n\n\n\n\n\n\nPeru\n\n\nR programming\n\n\nData-Science\n\n\nHydrological Modeling\n\n\nClimate Change\n\n\n\n\nYou can check here my available training courses on some hydrology topics (dictados en español).\n\n\n\n\n\n\nMay 15, 2023\n\n\nHarold Llauca\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2023-06-02_training_courses/index.html",
    "href": "posts/2023-06-02_training_courses/index.html",
    "title": "Training courses",
    "section": "",
    "text": "CitationBibTeX citation:@online{llauca2022,\n  author = {Llauca, Harold},\n  title = {Training Courses},\n  date = {2022-10-24},\n  url = {https://samanthacsik.github.io/posts/2022-10-24-quarto-blogs/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLlauca, Harold. 2022. “Training Courses.” October 24, 2022.\nhttps://samanthacsik.github.io/posts/2022-10-24-quarto-blogs/."
  },
  {
    "objectID": "posts/2023-06-02-quarto-blogs/index.html",
    "href": "posts/2023-06-02-quarto-blogs/index.html",
    "title": "Training courses",
    "section": "",
    "text": "R aplicado a la Hidrología - Julio 2023 [Inscripciones abiertas]\nCurso-taller de entrenamiento en el lenguaje de programación R con aplicaciones en la Hidrología (introducción al lenguaje R, lectura y visualizacíon de datos, manejo de datos climáticos grillados, evaluación y modelación hidrológica).\n\nFechas: 15, 16, 22 y 23 de julio de 2023.\nDuración: 24 horas lectivas.\nModalidad: Online (sincrónico).\n\n\n\n\n\n\n\n\nR aplicado a la Hidrología - Abril 2023 [Finalizado]\nCurso-taller de entrenamiento en el lenguaje de programación R con aplicaciones en la Hidrología (introducción al lenguaje R, lectura y visualizacíon de datos, manejo de datos climáticos grillados, evaluación y modelación hidrológica).\n\n\n\n\n\n\n\nIntroducción a la modelación hidrológica estacional aplicando el modelo semidistribuido GR2M - Diciembre 2022 [Finalizado]\nCurso-taller de entrenamiento en el modelo conceptual GR2M, aplicando el paquete GR2MSemiDistr en la simulación hidrológica de caudales medios mensuales aplicando el lenguaje de programación R.\n\n\n\n\n\n\n\nModelos de Cambio Climático para la Evaluación de la Disponibilidad Hídrica Futura - Noviembre 2018 [Finalizado]\nCurso-taller de entrenamiento en la descarga, post-procesamiento, escalamiento estadístico y corrección del sesgo de Modelos Climáticos Globales del CMIP5, y su aplicación en la hidrología de cuencas.\n\n\n\n\n\n\n\n\n\nCitationBibTeX citation:@online{llauca2023,\n  author = {Llauca, Harold},\n  title = {Training Courses},\n  date = {2023-05-15},\n  url = {https://hllauca.github.io/posts/2023-06-02-quarto-blogs/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLlauca, Harold. 2023. “Training Courses.” May 15, 2023. https://hllauca.github.io/posts/2023-06-02-quarto-blogs/."
  },
  {
    "objectID": "posts/2023-06-04-quarto-blogs/index.html",
    "href": "posts/2023-06-04-quarto-blogs/index.html",
    "title": "Gridded hydro-meteorological data for Peru",
    "section": "",
    "text": "Ground hydro-meteorological observations are space-time limited in countries such as Peru. This data scarcity context impulses the use of Satellite Precipitation Products (SPP) in hydrological applications. SPPs provide gridded estimations of meteorological variables such as precipitation and air temperature with high temporal and spatial resolution. However; due to SPP biases, merging of ground information (gauges) and satellite information - using geostatistical techniques - might increase the representation of these variables in the whole country as is shown in the following figure.\n\n\n\nDaily rainfall rates [mm/d] for the Peruvian territory from PISCO product.\n\n\nHere, we describe gridded data-sets built for the Peruvian territory:\n\n\n\n\nThe PISCO product\nThe Peruvian Interpolated data of the SENAMHI’s Climatological and hydrological Observations (PISCO) is a hydro-meteorological gridded dataset developed for the Peruvian territory by the National Services of Meteorology and Hydrology of Peru (SENAMHI), including trans-boundary catchments with Ecuador and Colombia. PISCO contains sub-products of precipitation (P), air temperature (TA), and evapotranspiration (PE) variables.\nThe PISCOP sub-product is available from 1981 to 2016 (stable 2.1 version) at 0.1° spatial resolution. This precipitation sub-product (Aybar et al., 2020) is generated by using geostatistical and deterministic methods that include three precipitation sources: (a) the quality-controlled national rain gauge dataset, (b) radar-gauge merged precipitation climatologies, and (c) the Climate Hazards Group Infrared Precipitation (CHIRP) estimates, as is shown in the following figure. Also, an unstable version is available from 1981 to the present, and it is daily updated for SENAMHI’s operational purposes.\n\n\n\nSchematic framework of the PISCOP sub-product (stable version 2.1). Source: Aybar et al. (2020).\n\n\nSimilarly, PISCOTA version 1.1 (Huerta et al., 2018) is available from 1981 to 2016 at 0.1° spatial resolution, and it is obtained from: a) time series of maximum and minimum air temperature data, (b) a soil temperature product from the MODIS sensor (Moderate Resolution Imaging Spectroradiometer), and (c) geographic predictors (e.g., elevation, longitude, latitude and Topographic Dissection Index). Also, a new PISCOTA version 1.2 (Huerta et al., 2023) is now available. This new air temperature version captures complex spatial variability of maximum and minimum air temperature at a more accurate scale compared to the previous version, and it is available from 1981 to 2020 at 0.01° horizontal resolution.\n\n\n\nSchematic framework of the PISCOTA sub-product (version 1.2). Source: Huerta et al. (2023).\n\n\nRecently, the new PISCOPE sub-product (Huerta et al., 2022) has been generated with the Penman-Monteith equation following the scheme detailed below. Evapotranspiration sub-product is available from 1981 to 2016 at 0.01° spatial resolution. Note that it uses a downscaled version of the PISCOTA version 1.1.\n\n\n\nSchematic framework of the PISCOPE sub-product (version1.0). Source: Huerta et al. (2022).\n\n\n\n\n\n\n\nThe RAIN4PE product\nAccording to the POTSDAM INSTITUTE FOR CLIMATE IMPACT RESEARCH (PIK), RAIN4PE (Fernandez-Palomino et al., 2021) is a novel daily gridded precipitation data set obtained by merging multi-source precipitation data (satellite-based Climate Hazards Group InfraRed Precipitation, CHIRP (Funk et al. 2015), reanalysis ERA5 (Hersbach et al. 2020), and ground-based precipitation) with terrain elevation using the random forest regression method. Furthermore, RAIN4PE is hydrologically corrected using streamflow data in catchments with precipitation underestimation through reverse hydrology. Hence, RAIN4PE is the only gridded precipitation product for Peru and Ecuador, which benefits from maximum available in-situ observations, multiple precipitation sources, elevation data, and is supplemented by streamflow data to correct the precipitation underestimation over páramos and montane catchments.\n\n\n\nSchematic framework of the RAIN4PE product. Source: Fernandez et al. (2022).\n\n\nThe RAIN4PE data are available for the terrestrial land surface between 19°S-2°N and 82-67°W, at 0.1° spatial and daily temporal resolution from 1981 to 2015. The precipitation data set is provided in netCDF format.\n\n\n\n\n\nWhat is the NetCDF format?\nThe Network Common Data Form (NetCDF) is a format for the storage of multidimensional (variables) scientific data. There are a large number of software and libraries to read netCDF files such as Panoply software, the ncdf4 R package, or the netCDF4 package in Python.\n\n\n\nStructure of a netCDF file. Source: www.guillaumedueymes.com.\n\n\nThe PISCO and RAIN4PE data-sets are available in the netCDF format, and consider one variable (precipitation, air temperature, or evapotranspiration) and three dimensions (longitude, latitude and time).\n\n\n\n\n\nHow to access these gridded data sets?\nThese data sets could be downloaded from Drive. Filenames follow the format “productname_timevariable_version.nc”, where the timevariable field is described as d = daily timestep; m = monthly timestep, pr = precipitation, tn = minimum air temperature, tx = maximum air temperature, and pe = evapotranspiration.\n\n\n\nScheme of current available gridded hydro-meteorological data sets for Peru.\n\n\n\n\n\n\n\nReferences\nAybar, Cesar, Carlos Fernández, Adrian Huerta, Waldo Lavado, Fiorella Vega, and Oscar Felipe-Obando. 2019. “Construction of a High-Resolution Gridded Rainfall Dataset for Peru from 1981 to the Present Day.” Hydrological Sciences Journal 65 (5): 770–85. https://doi.org/10.1080/02626667.2019.1649411.\nFernandez-Palomino, C.A., Hattermann, F.F., Krysanova, V., Lobanova, A., Vega-Jacome, ´ F., Lavado, W., Santini, W., Aybar, C., Bronstert, A., 2021. A novel highresolution gridded precipitation dataset for Peruvian and Ecuadorian watersheds – development and hydrological evaluation. J. Hydrometeorol. 1. https://doi. org/10.1175/jhm-d-20-0285.1.\nHuerta, A.; Aybar, C.; Lavado-Casimiro, W. PISCO temperatura v.1.1. SENAMHI - DHI-2018, Lima-Perú. Available on http://iridl.ldeo.columbia.edu/documentation/.pisco/.PISCOt_report.pdf.\nHuerta, Adrian, Vivien Bonnesoeur, José Cuadros-Adriazola, Leonardo Gutierrez, Boris F. Ochoa-Tocachi, Francisco Román-Dañobeytia, and Waldo Lavado-Casimiro. 2022. “PISCOeo_pm, a Reference Evapotranspiration Gridded Database Based on FAO Penman-Monteith in Peru.” Scientific Data 9 (1). https://doi.org/10.1038/s41597-022-01373-8.\nHuerta, A., Aybar, C., Imfeld, N., Correa, K., Felipe-Obando, O., Rau, P., Drenkhan, F., & Lavado-Casimiro, W. (2023). High-resolution grids of daily air temperature for Peru - the new PISCOt v1.2 dataset. Scientific Data, 10(1), 847. https://doi.org/10.1038/s41597-023-02777-w\n\n\n\n\nCitationBibTeX citation:@online{llauca2023,\n  author = {Llauca, Harold},\n  title = {Gridded Hydro-Meteorological Data for {Peru}},\n  date = {2023-06-04},\n  url = {https://hllauca.github.io/posts/2023-06-04-quarto-blogs/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLlauca, Harold. 2023. “Gridded Hydro-Meteorological Data for\nPeru.” June 4, 2023. https://hllauca.github.io/posts/2023-06-04-quarto-blogs/."
  },
  {
    "objectID": "posts/2023-05-15-quarto-blogs/index.html",
    "href": "posts/2023-05-15-quarto-blogs/index.html",
    "title": "Training courses",
    "section": "",
    "text": "Impacto del Cambio Climático sobre los Recursos Hídricos - Noviembre 2023 [Open]\nEste curso-taller pretende abordar el entendimiento de los conceptos sobre climatología y sus procesos a escala del Perú, El Fenómeno El Niño, modelos climáticos, estado actual del cambio climático a nivel nacional, métodos de downscalling para utilizar los modelos GCM, ejemplos de aplicación de escenarios de cambio climático en el Perú; y utilizar los modelos GCM para evaluar su impacto sobre la hidrología en el Perú basado en un modelo hidrológico semi-distribuido. Más información aquí.\n\n\n\nR aplicado a la Hidrología - Abril & Julio 2023 [Closed]\nCurso-taller de entrenamiento en el lenguaje de programación R con aplicaciones en la Hidrología (introducción al lenguaje R, lectura y visualizacíon de datos, manejo de datos climáticos grillados, evaluación y modelación hidrológica).\n\n\n\n\n\n\n\nIntroducción a la modelación hidrológica estacional aplicando el modelo semidistribuido GR2M - Diciembre 2022 [Closed]\nCurso-taller de entrenamiento en el modelo conceptual GR2M, aplicando el paquete GR2MSemiDistr en la simulación hidrológica de caudales medios mensuales aplicando el lenguaje de programación R.\n\n\n\n\n\n\n\nModelos de Cambio Climático para la Evaluación de la Disponibilidad Hídrica Futura - Noviembre 2018 [Closed]\nCurso-taller de entrenamiento en la descarga, post-procesamiento, escalamiento estadístico y corrección del sesgo de Modelos Climáticos Globales del CMIP5, y su aplicación en la hidrología de cuencas.\n\n\n\n\n\n\n\n\n\nCitationBibTeX citation:@online{llauca2023,\n  author = {Llauca, Harold},\n  title = {Training Courses},\n  date = {2023-05-15},\n  url = {https://hllauca.github.io/posts/2023-05-15-quarto-blogs/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLlauca, Harold. 2023. “Training Courses.” May 15, 2023. https://hllauca.github.io/posts/2023-05-15-quarto-blogs/."
  },
  {
    "objectID": "posts/2023-06-12-quarto-blogs/index.html",
    "href": "posts/2023-06-12-quarto-blogs/index.html",
    "title": "How to calibrate hydrological models?",
    "section": "",
    "text": "Models aim to represent hydrological systems using different kinds of mathematical simplifications (e.g. physical-based, conceptual, empirical) or spatial discretization approaches (distributed, semi-distributed, lumped). These models are capable of anticipating system response (e.g. in terms of water discharges) from forcing changes (e.g. precipitation). However, system uncertainties are implicit in the model from different sources such as: model forcings (u), parameters (θ), states (X), structure (M), or outputs (Y); as described by Liu & Gupta (2011). What is more, model errors (\\(\\varepsilon\\)) directly impact streamflow simulation due to propagation throw the model system - from inputs to outputs - as is shown in the following equation, where t is the time:\n \\[\nY_{t} = M(u_{t},X_{t-1},θ, \\varepsilon)\n\\]\n\nIn that context, model calibration techniques help to reduce parameter uncertainties and improve the streamflow representation.\n\n\n\nModel optimization\nThe main focus of the model optimization procedure is to reduce errors between observed and simulated responses of the hydrological system throw parameter modification as described by Vrugt et al. (2013).\n\n\n\nSchematic overview of the model calibration problem. Source: Vrugt et al. (2013).\n\n\n\nThis objective might be explained by a minimization problem, where the cost function J represents errors between simulations (Ysim) and observations (Yobs):\n\n\\[\nminJ = \\varepsilon_{(Ysim - Yobs)}\n\\]\n\nThe cost function is commonly named the Objective Function (OF) and J might be expressed in terms of some statistical metrics such as the Root Mean Square Error (RMSE), where n represent the length of the time series and i is the time step.\n \n\\[\nminOF = minRMSE = min(\\sqrt{\\frac{1}{n}\\sum_{i}^{n}\\left ( Y_{sim,i} - Y_{obs,i} \\right )^2})\n\\]\n\nThere are other statistical metrics used in model calibration such as the popular Nash-Sutcliffe (NSE) or the Kling and Gupta (KGE) efficiency criterion. In both cases, higher values near 1 indicate a very good adjustment of simulations to observations, so the OF should be expressed as a maximization problem or a minimization problem of the negative metrics as follows:\n  \\[\nmaxNSE = min(-1*NSE) = min(\\frac{\\sum_{i=1}^{n}(Y_{sim,i}-Y_{obs,i})^2}{\\sum_{i=1}^{n}(Y_{obs,i}-\\bar{Y_{obs}})^2})\n\\]\n\n\\[\nmaxKGE = min(-1*KGE) = min(\\sqrt{(r-1)^2+(\\frac{\\sigma _{sim}}{\\sigma _{obs}}-1)^2+(\\frac{\\mu _{sim}}{\\mu _{obs}}-1)^2})\n\\]\n\nStatistical metrics help to quantify the agreements between observed and calculated discharges. For example, Ferreira et al. (2020) evaluate 36 OF proposed in the literature and confirm that each metric should be interpreted specifically thinking about the aspects it has been proposed for (e.g. such as for low-flows, high-flows, etc). Also, a set of goodness-of-fit functions for comparison of simulated and observed hydrological time series could be found in the hydroGOF R package.\nMono-objective methods solve an optimization problem with a unique objective function as shown above. Hence, they might contain more than one metric using a linear expression of metrics and weights:\n \n\\[\nminOF = a*RMSE - b*NSE - c*KGE\n\\]\n\nAlso, multi-objective optimizations have been tested in hydrological modeling calibration to include more than a unique objective function with a Pareto optimization approach. For instance, Yeste et al. (2023) compare multi- and mono-objective calibration algorithms to integrate streamflow (Q) and evaporation (E) data in hydrological modeling.\n\n\n\nMulti-objective calibration. Source: Yeste et al. (2023).\n\n\n\n\n\nOptimization algorithms\nSearching for the set of optimal model parameters might be an overwhelming task. The Shuffle Complex Evolutionary (SCE) algorithm is one of the most popular functions for mono-objective and global automatic calibration of hydrological model parameters. According to Duan et al. (1993), the SCE method is based on a synthesis of four concepts that have proved successful for global optimization: (a) combination of probabilistic and deterministic approaches; (b) clustering; (c) systematic evolution of a complex of points spanning the space, in the direction of global improvement; and (d) competitive evolution.\nThe following list presents some functions and packages available in the R language programming for the optimization of hydrological models:\n\nsceua: Mono-objective calibration function using the Shuffle Complex Evolutionary (SCE) algorithm.\nhydroPSO: Enhanced Particle Swarm Optimisation (PSO) algorithm.\nga: Maximization of a fitness function using Genetic Algorithms (GA).\ndream: DiffeRential Evolution Adaptive Metropolis (DREAM). Efficient global MCMC even in high-dimensional spaces.\nnsga2R: Multi-objective calibration with the R Based Non-dominated Sorting Genetic Algorithm II.\nrmoo: Framework for multi- and many-objective optimization, which allows researchers and users versatility in parameter configuration, as well as tools for analysis, replication, and visualization of results.\ncaRamel: R package for optimization implementing a multiobjective evolutionary algorithm combining the MEAS algorithm and the NGSA-II algorithm.\nGPareto: Multi-objective Expected Improvement and Step-wise Uncertainty Reduction sequential infill criteria.\n\n\n\n\n\n\nCalibration or validation?\nHydrological models require the development of two main steps before their operation. The calibration step consists of the selection of a window period where optimal model parameters are identified throw the procedure described lines above, while the validation step is about the use of these optimal parameters set in a new non-tested time window. In that sense, the assessment of model performance - using different statistical metrics - is computed during calibration and validation periods.\n\n\n\n\nCalibrated and validated streamflow time series in a lumped hydrological model.\n\n\nThe warm-up period is a previous step inside the model calibration used to reduce initial condition uncertainties. For instance, in daily models, the first-year calibration model period is discarded from the OF and statistical performance metrics to make model outputs independent from initial model states.\n\n\n\n\nReferences\nDuan, Q. Y., V. K. Gupta, and S. Sorooshian. 1993. “Shuffled Complex Evolution Approach for Effective and Efficient Global Minimization.” Journal of Optimization Theory and Applications 76 (3): 501–21. https://doi.org/10.1007/BF00939380.\nFerreira, Paloma Mara de Lima, Adriano Rolim da Paz, and Juan Martín Bravo. 2020. “Objective Functions Used as Performance Metrics for Hydrological Models: State-of-the-Art and Critical Analysis.” RBRH 25. https://doi.org/10.1590/2318-0331.252020190155.\nLiu, Yuqiong, and Hoshin V. Gupta. 2007. “Uncertainty in Hydrologic Modeling: Toward an Integrated Data Assimilation Framework.” Water Resources Research 43 (7): 160. https://doi.org/10.1029/2006WR005756.\nVrugt, Jasper A., Cajo J. F. ter Braak, Cees G. H. Diks, and Gerrit Schoups. 2013. “Hydrologic Data Assimilation Using Particle Markov Chain Monte Carlo Simulation: Theory, Concepts and Applications.” Advances in Water Resources 51 (January): 457–78. https://doi.org/10.1016/j.advwatres.2012.04.002.\nYeste, Patricio, Lieke A. Melsen, Matilde García-Valdecasas Ojeda, Sonia R. Gámiz-Fortis, Yolanda Castro-Díez, and María Jesús Esteban-Parra. 2023. “A Pareto‐based Sensitivity Analysis and Multiobjective Calibration Approach for Integrating Streamflow and Evaporation Data.” Water Resources Research 59 (6). https://doi.org/10.1029/2022wr033235.\n\n\n\n\n\n\nCitationBibTeX citation:@online{llauca2023,\n  author = {Llauca, Harold},\n  title = {How to Calibrate Hydrological Models?},\n  date = {2023-06-12},\n  url = {https://hllauca.github.io/posts/2023-06-12-quarto-blogs/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLlauca, Harold. 2023. “How to Calibrate Hydrological\nModels?” June 12, 2023. https://hllauca.github.io/posts/2023-06-12-quarto-blogs/."
  }
]